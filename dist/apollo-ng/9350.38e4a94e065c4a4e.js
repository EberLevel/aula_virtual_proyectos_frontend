"use strict";(self.webpackChunkapollo_ng=self.webpackChunkapollo_ng||[]).push([[9350],{9350:(z,p,l)=>{l.r(p),l.d(p,{CalendarAppModule:()=>Y});var g=l(6814),c=l(6223),h=l(8007),Z=l(5932),E=l(6111),y=l(3023),e=l(8926),v=l(6031),M=l(375),m=l(2495),u=l(3530),A=l(5219),f=l(6218),_=l(6760),C=l(3714),x=l(3965);function b(o,r){if(1&o&&(e.TgZ(0,"span",7),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Oqu("display"===t.view?t.changedEvent.title:"new"===t.view?"Nuevo Evento":"Editar Evento")}}function D(o,r){if(1&o&&(e.TgZ(0,"div")(1,"div",9)(2,"div",10)(3,"div",11),e._uU(4,"Inicio"),e.qZA(),e.TgZ(5,"p",12),e._UZ(6,"i",13),e.TgZ(7,"span"),e._uU(8),e.qZA()()(),e.TgZ(9,"div",10)(10,"div",11),e._uU(11,"Fin"),e.qZA(),e.TgZ(12,"p",12),e._UZ(13,"i",13),e.TgZ(14,"span"),e._uU(15),e.qZA()()(),e.TgZ(16,"div",14)(17,"div",11),e._uU(18,"Color"),e.qZA(),e.TgZ(19,"p",12),e._UZ(20,"span",15),e.TgZ(21,"span"),e._uU(22),e.qZA()()()()()),2&o){const t=e.oxw(2);e.xp6(8),e.Oqu(t.changedEvent.start.toISOString().slice(0,10)),e.xp6(7),e.Oqu(t.changedEvent.end.toISOString().slice(0,10)),e.xp6(5),e.Udp("background-color",t.changedEvent.tag.color),e.xp6(2),e.Oqu(t.changedEvent.tag.name)}}function w(o,r){if(1&o&&(e.TgZ(0,"div",37),e._UZ(1,"div",38),e.TgZ(2,"div"),e._uU(3),e.qZA()()),2&o){const t=e.oxw(4);e.xp6(1),e.Udp("background-color",t.changedEvent.tag.color),e.xp6(2),e.Oqu(t.changedEvent.tag.name)}}function S(o,r){if(1&o&&e.YNc(0,w,4,3,"div",36),2&o){const t=e.oxw(3);e.Q6J("ngIf",t.changedEvent.tag)}}function O(o,r){if(1&o&&(e.TgZ(0,"div",37),e._UZ(1,"div",38),e.TgZ(2,"div"),e._uU(3),e.qZA()()),2&o){const t=r.$implicit;e.xp6(1),e.Udp("background-color",t.color),e.xp6(2),e.Oqu(t.name)}}function U(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"div",16)(2,"div",17)(3,"label",18),e._uU(4,"T\xedtulo"),e.qZA(),e.TgZ(5,"span",19),e._UZ(6,"i",20),e.TgZ(7,"input",21),e.NdJ("ngModelChange",function(a){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changedEvent.title=a)}),e.qZA()()(),e.TgZ(8,"div",17)(9,"label",22),e._uU(10,"Ubicaci\xf3n"),e.qZA(),e.TgZ(11,"span",19),e._UZ(12,"i",23),e.TgZ(13,"input",24),e.NdJ("ngModelChange",function(a){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changedEvent.location=a)}),e.qZA()()(),e.TgZ(14,"div",25)(15,"label",26),e._uU(16,"Descripci\xf3n del evento"),e.qZA(),e.TgZ(17,"textarea",27),e.NdJ("ngModelChange",function(a){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changedEvent.description=a)}),e.qZA()(),e.TgZ(18,"div",17)(19,"label",28),e._uU(20,"Fecha de Inicio"),e.qZA(),e.TgZ(21,"p-calendar",29),e.NdJ("ngModelChange",function(a){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changedEvent.start=a)}),e.qZA()(),e.TgZ(22,"div",17)(23,"label",30),e._uU(24,"Fecha Fin"),e.qZA(),e.TgZ(25,"p-calendar",31),e.NdJ("ngModelChange",function(a){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changedEvent.end=a)}),e.qZA()(),e.TgZ(26,"div",25)(27,"label",32),e._uU(28,"Color"),e.qZA(),e.TgZ(29,"p-dropdown",33),e.NdJ("ngModelChange",function(a){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changedEvent.tag=a)}),e.YNc(30,S,1,1,"ng-template",34),e.YNc(31,O,4,3,"ng-template",35),e.qZA()()()()}if(2&o){const t=e.oxw(2),n=e.MAs(3);e.xp6(7),e.Q6J("ngModel",t.changedEvent.title),e.xp6(6),e.Q6J("ngModel",t.changedEvent.location),e.xp6(4),e.Q6J("rows",5)("ngModel",t.changedEvent.description),e.xp6(4),e.Q6J("appendTo",n)("maxDate",t.changedEvent.end)("showTime",!0)("required",!0)("ngModel",t.changedEvent.start),e.xp6(4),e.Q6J("appendTo",n)("minDate",t.changedEvent.start)("showTime",!0)("required",!0)("ngModel",t.changedEvent.end),e.xp6(4),e.Q6J("appendTo",n)("options",t.tags)("ngModel",t.changedEvent.tag)}}function k(o,r){if(1&o&&(e.YNc(0,D,23,5,"div",8),e.YNc(1,U,32,17,"div",8)),2&o){const t=e.oxw();e.Q6J("ngIf","display"===t.view),e.xp6(1),e.Q6J("ngIf","display"!==t.view)}}function I(o,r){}const J=function(){return{width:"36rem"}},N=function(){return{"960px":"75vw","640px":"90vw"}};let F=(()=>{class o{constructor(t,n){this.eventService=t,this.helpersService=n,this.events=[],this.today="",this.calendarOptions={initialView:"dayGridMonth"},this.showDialog=!1,this.clickedEvent=null,this.dateClicked=!1,this.edit=!1,this.tags=[],this.view="",this.courseStyles={}}ngOnInit(){this.today=(new Date).toISOString().split("T")[0];const t={alumno_id:this.helpersService.getAlumnoId()??1,domain_id:this.helpersService.getDominioId()};this.eventService.getEventsAlumno(t).subscribe(n=>{this.events=this.getEventsAlumno(n),this.calendarOptions={...this.calendarOptions,events:this.events},this.tags=this.events.map(a=>{if(!this.tags.includes(a.tag))return a.tag})}),this.calendarOptions={plugins:[Z.Z,y.Z,E.ZP],height:720,initialDate:this.today,headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,eventClick:n=>this.onEventClick(n),select:n=>this.onDateSelect(n),events:this.events}}getEventsAlumno(t){const n=t.map(a=>{const i=JSON.parse(a.horarios);return this.generateEventDetails(i,a.nombre)});return console.log(n.flat()),n.flat()}generateEventDetails(t,n){const a=[],i=this.getCourseStyles(n);return t.forEach(d=>{const H=new Date(d.fecha_inicio),j=new Date(d.fecha_fin),T=d.day_id;for(let s=new Date(H);s<=j;s=this.addDays(s,1))if(s.getDay()===T%7){const K=`${s.toISOString().split("T")[0]}T${d.hora_inicio}`,$=`${s.toISOString().split("T")[0]}T${d.hora_fin}`;a.push({day_name:this.getDayName(T),date:s.toISOString().split("T")[0],end:$,start:K,tag:{color:"#FFD700",name:n+"-"+d.docente_name},title:n,borderColor:i.borderColor,backgroundColor:i.backgroundColor,textColor:i.textColor})}}),a}getCourseStyles(t){if(this.courseStyles[t])return this.courseStyles[t];const n=this.generateStyles();return this.courseStyles[t]=n,n}getDayName(t){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t%7]}addDays(t,n){const a=new Date(t);return a.setDate(a.getDate()+n),a}generateStyles(){const n=["#f9e79f","#a3e4d7","#abebc6","#f5b041","#ec7063","#cacfd2"],a=["#000000"],i=n[Math.floor(Math.random()*n.length)];return{backgroundColor:i,borderColor:i,textColor:a[Math.floor(Math.random()*a.length)]}}onEventClick(t){this.clickedEvent=t.event;let n=t.event.toPlainObject({collapseExtendedProps:!0,collapseColor:!0});this.view="display",this.showDialog=!0,this.changedEvent={...n,...this.clickedEvent},this.changedEvent.start=this.clickedEvent.start,this.changedEvent.end=this.clickedEvent.end?this.clickedEvent.end:this.clickedEvent.start}onDateSelect(t){}handleSave(){this.validate()&&(this.showDialog=!1,this.clickedEvent={...this.changedEvent,backgroundColor:this.changedEvent.tag.color,borderColor:this.changedEvent.tag.color,textColor:"#212121"},this.events=this.clickedEvent.hasOwnProperty("id")?this.events.map(t=>t.id.toString()===this.clickedEvent.id.toString()?t=this.clickedEvent:t):[...this.events,{...this.clickedEvent,id:Math.floor(1e4*Math.random())}],this.calendarOptions={...this.calendarOptions,events:this.events},this.clickedEvent=null)}onEditClick(){this.view="edit"}delete(){this.events=this.events.filter(t=>t.id.toString()!==this.clickedEvent.id.toString()),this.calendarOptions={...this.calendarOptions,events:this.events},this.showDialog=!1}validate(){let{start:t,end:n}=this.changedEvent;return t&&n}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(v.P),e.Y36(M.$))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["ng-component"]],decls:7,vars:9,consts:[[1,"card"],[3,"options"],[3,"visible","breakpoints","modal","closable","visibleChange","onHide"],["dd",""],["pTemplate","header"],["pTemplate","content"],["pTemplate","footer"],[1,"text-900","font-semibold","text-xl"],[4,"ngIf"],[1,"grid"],[1,"col-6"],[1,"text-900","font-semibold","mb-2"],[1,"flex","align-items-center","m-0"],[1,"pi","pi-fw","pi-clock","text-700","mr-2"],[1,"col-12"],[1,"inline-flex","flex-shrink-0","w-1rem","h-1rem","mr-2","border-circle"],[1,"grid","p-fluid","formgrid"],[1,"col-12","md:col-6","field"],["for","title",1,"text-900","font-semibold"],[1,"p-input-icon-left"],[1,"pi","pi-pencil"],["id","title","type","text","pInputText","","placeholder","T\xedtulo",3,"ngModel","ngModelChange"],["for","location",1,"text-900","font-semibold"],[1,"pi","pi-map-marker"],["id","location","type","text","pInputText","","placeholder","Ubicaci\xf3n",3,"ngModel","ngModelChange"],[1,"col-12","field"],["for","description",1,"text-900","font-semibold"],["id","description","type","text","pInputTextarea","",2,"resize","none",3,"rows","ngModel","ngModelChange"],["for","start",1,"text-900","font-semibold"],["dateFormat","dd-mm-yy","inputId","start",3,"appendTo","maxDate","showTime","required","ngModel","ngModelChange"],["for","end",1,"text-900","font-semibold"],["dateFormat","dd-mm-yy","inputId","end",3,"appendTo","minDate","showTime","required","ngModel","ngModelChange"],["for","company-color",1,"text-900","font-semibold"],["inputId","company-color","optionLabel","name",3,"appendTo","options","ngModel","ngModelChange"],["pTemplate","selectedItem"],["pTemplate","item"],["class","flex align-items-center",4,"ngIf"],[1,"flex","align-items-center"],[1,"flex-shrink-0","w-1rem","h-1rem","mr-2","border-circle"]],template:function(n,a){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"full-calendar",1),e.TgZ(2,"p-dialog",2,3),e.NdJ("visibleChange",function(d){return a.showDialog=d})("onHide",function(){return a.view=""}),e.YNc(4,b,2,1,"ng-template",4),e.YNc(5,k,2,2,"ng-template",5),e.YNc(6,I,0,0,"ng-template",6),e.qZA()()),2&n&&(e.xp6(1),e.Q6J("options",a.calendarOptions),e.xp6(1),e.Akn(e.DdM(7,J)),e.Q6J("visible",a.showDialog)("breakpoints",e.DdM(8,N))("modal",!0)("closable",!0))},dependencies:[g.O5,c.Fj,c.JJ,c.Q7,c.On,m.w,u.V,A.jx,f.g,_.f,C.o,x.Lt],styles:["@media screen and (max-width: 768px){[_nghost-%COMP%]     .fc .fc-toolbar{justify-content:center}[_nghost-%COMP%]     .fc-header-toolbar{display:flex;align-items:center;gap:1rem;justify-content:center;text-align:center;flex-wrap:wrap}[_nghost-%COMP%]     .fc-header-toolbar .fc-toolbar-chunk:nth-child(2){width:100%;order:0}[_nghost-%COMP%]     .fc-header-toolbar .fc-toolbar-chunk:nth-child(1){order:1}[_nghost-%COMP%]     .fc-header-toolbar .fc-toolbar-chunk:nth-child(3){order:2}[_nghost-%COMP%]     .fc-header-toolbar .fc-toolbar-chunk:nth-child(3) .fc-button-group .fc-today-button{margin-left:2rem}}"]})}return o})(),P=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.oAB({type:o});static#n=this.\u0275inj=e.cJS({imports:[h.Bz.forChild([{path:"",component:F}]),h.Bz]})}return o})();var q=l(707),Q=l(4480),G=l(4104);let Y=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.oAB({type:o});static#n=this.\u0275inj=e.cJS({providers:[v.P],imports:[g.ez,c.u5,P,m.z,u.S,f.A,q.hJ,_._8,C.j,x.kW,G.EV,Q.T]})}return o})()}}]);