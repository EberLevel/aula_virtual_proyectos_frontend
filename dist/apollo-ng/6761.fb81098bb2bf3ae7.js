"use strict";(self.webpackChunkapollo_ng=self.webpackChunkapollo_ng||[]).push([[6761],{6761:(A,f,n)=>{n.r(f),n.d(f,{ForoAlumnosRoutingModule:()=>X});var r=n(8007),h=n(1230),m=n(6223),x=n(6760),y=n(9552),d=n(6022),C=n(707),u=n(7902),p=n(3714),g=n(6218),b=n(6804),_=n(4480),F=n(4055),O=n(3965),Z=n(6651),R=n(4104),D=n(1494),S=n(3722),P=n(3259),J=n(3904),M=n(9537),T=n(3530),E=n(5118),H=n(3999),e=n(8926),w=n(7649),I=n(375),U=n(5219),v=n(6814);function z(o,c){1&o&&(e.TgZ(0,"span",6),e._uU(1,"Foros"),e.qZA())}function L(o,c){if(1&o&&(e.TgZ(0,"li",31)(1,"div",32)(2,"span",33),e._uU(3),e.qZA(),e.TgZ(4,"span",34),e._uU(5),e.ALo(6,"date"),e.qZA()(),e._UZ(7,"p",35),e.qZA()),2&o){const t=c.$implicit;e.xp6(3),e.Oqu(t.alumno),e.xp6(2),e.Oqu(e.xi3(6,3,t.fecha,"dd/MM/yyyy HH:mm")),e.xp6(2),e.Q6J("innerHTML",t.respuesta,e.oJD)}}function B(o,c){if(1&o&&(e.TgZ(0,"ul",29),e.YNc(1,L,8,6,"li",30),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.subrespuestas)}}function N(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"li",22)(1,"div",23)(2,"span",24),e._uU(3),e.qZA(),e.TgZ(4,"span",25),e._uU(5),e.ALo(6,"date"),e.qZA()(),e._UZ(7,"p",26),e.TgZ(8,"button",27),e.NdJ("click",function(){const l=e.CHM(t).$implicit,a=e.oxw().$implicit,k=e.oxw(2);return e.KtG(k.selectForo(a,l))}),e.qZA(),e.YNc(9,B,2,1,"ul",28),e.qZA()}if(2&o){const t=c.$implicit,i=e.oxw().$implicit,s=e.oxw(2);e.xp6(3),e.Oqu(t.alumno),e.xp6(2),e.Oqu(e.xi3(6,5,t.fecha,"dd/MM/yyyy HH:mm")),e.xp6(2),e.Q6J("innerHTML",t.respuesta,e.oJD),e.xp6(1),e.Q6J("disabled",s.isExpired(i.fecha_fin)),e.xp6(1),e.Q6J("ngIf",t.subrespuestas&&t.subrespuestas.length>0)}}function Q(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div",12)(1,"h3",13),e._uU(2),e.qZA(),e._UZ(3,"p",14),e.TgZ(4,"div",15),e._UZ(5,"i",16),e.TgZ(6,"span",17),e._uU(7),e.ALo(8,"date"),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"span",18),e._uU(11),e.qZA()(),e.TgZ(12,"ul",19),e.YNc(13,N,10,8,"li",20),e.qZA(),e.TgZ(14,"button",21),e.NdJ("click",function(){const l=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.selectForo(l))}),e.qZA()()}if(2&o){const t=c.$implicit,i=e.oxw(2);e.xp6(2),e.Oqu(t.foro_name),e.xp6(1),e.Q6J("innerHTML",t.foro_pregunta,e.oJD),e.xp6(4),e.AsE("Inicio: ",e.xi3(8,8,t.fecha_inicio,"dd/MM/yyyy")," | Fin: ",e.xi3(9,11,t.fecha_fin,"dd/MM/yyyy"),""),e.xp6(3),e.Q6J("ngClass",i.getDaysRemainingClass(t.fecha_fin)),e.xp6(1),e.hij(" (",i.getDaysRemaining(t.fecha_fin),") "),e.xp6(2),e.Q6J("ngForOf",t.respuestas),e.xp6(1),e.Q6J("disabled",i.isExpired(t.fecha_fin))}}function Y(o,c){if(1&o&&(e.TgZ(0,"div",7)(1,"div",8)(2,"h2",9),e._uU(3),e.qZA(),e.TgZ(4,"h3",10),e._uU(5),e.qZA()(),e.YNc(6,Q,15,14,"div",11),e.qZA()),2&o){const t=c.$implicit;e.xp6(3),e.hij("Curso: ",t.curso_name,""),e.xp6(2),e.hij("Docente: ",t.docente_name,""),e.xp6(1),e.Q6J("ngForOf",t.foros)}}function j(o,c){if(1&o&&(e.TgZ(0,"div",36)(1,"h4",37),e._uU(2,"Respondiendo a:"),e.qZA(),e._UZ(3,"p",38),e.TgZ(4,"p",39),e._uU(5),e.ALo(6,"date"),e.qZA()()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("innerHTML",t.selectedRespuesta.respuesta,e.oJD),e.xp6(2),e.AsE("",t.selectedRespuesta.alumno," - ",e.xi3(6,3,t.selectedRespuesta.fecha,"dd/MM/yyyy HH:mm"),"")}}function $(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.submitResponse())}),e.qZA(),e.TgZ(1,"button",41),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.cancelResponse())}),e.qZA()}}const K=function(){return{width:"60vw"}},V=function(){return{"960px":"75vw","640px":"100vw"}},G=function(){return{height:"320px"}};let W=(()=>{class o{constructor(t,i){this.foroService=t,this.helperService=i,this.foros=[],this.selectedForo=null,this.newResponse="",this.selectedRespuesta=null}ngOnInit(){this.domain_id=this.helperService.getDominioId(),this.getForos()}getForos(){this.foroService.getForos(this.domain_id,this.helperService.getAlumnoId(),this.helperService.getDocenteId()).subscribe(t=>{this.foros=t.map(i=>({...i,foros:i.foros.map(s=>({...s,respuestas:s.respuestas.map(l=>({...l,subrespuestas:l.subrespuestas}))}))})),console.log("Foros cargados:",this.foros)},t=>console.error("Error al cargar los foros",t))}selectForo(t,i,s){this.selectedForo=t,this.selectedRespuesta=s||i||null,this.newResponse=""}isExpired(t){return new Date>new Date(t)}cancelResponse(){this.selectedForo=null,this.selectedRespuesta=null,this.newResponse=""}submitResponse(){if(this.selectedForo&&this.newResponse){console.log(this.selectedRespuesta);const t={id_foro:this.selectedForo.id_foro,respuesta:this.newResponse,domain_id:this.helperService.getDominioId(),alumno_id:this.helperService.getAlumnoId(),docente_id:this.helperService.getDocenteId(),id_respuesta:this.selectedRespuesta?this.selectedRespuesta.id:null};this.foroService.sendResponse(t).subscribe(i=>{console.log("Respuesta enviada:",i),this.helperService.showSuccessMessage("Respuesta enviada correctamente"),this.getForos()}),this.newResponse="",this.selectedForo=null}}getDaysRemaining(t){const i=new Date,l=new Date(t).getTime()-i.getTime(),a=Math.ceil(l/864e5);return a<0?"Vencido":a.toString()+" d\xedas"}getDaysRemainingClass(t){const i=new Date,l=new Date(t).getTime()-i.getTime(),a=Math.ceil(l/864e5);return a<0?"days-remaining overdue":a<=7?"days-remaining due-soon":"days-remaining on-time"}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(w.f),e.Y36(I.$))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-foro-alumnos"]],decls:7,vars:13,consts:[["pTemplate","header"],["class","mb-8",4,"ngFor","ngForOf"],["header","Dejar una respuesta",3,"visible","modal","breakpoints","visibleChange"],["class","mb-4 p-3 bg-gray-100 rounded",4,"ngIf"],[3,"ngModel","ngModelChange"],["pTemplate","footer"],[1,"text-primary","font-semibold","text-2xl"],[1,"mb-8"],[1,"forum-header","bg-gray-100","p-4","rounded-t-lg"],[1,"text-xl","font-bold"],[1,"text-lg"],["class","forum-detail bg-white p-4 border border-gray-200 mb-4 rounded-b-lg shadow",4,"ngFor","ngForOf"],[1,"forum-detail","bg-white","p-4","border","border-gray-200","mb-4","rounded-b-lg","shadow"],[1,"text-xl","font-semibold","mb-4"],[1,"text-gray-700",3,"innerHTML"],[1,"forum-dates","flex","items-center","mb-4"],[1,"pi","pi-calendar","mr-2","text-blue-500"],[1,"mr-2"],[1,"font-semibold","px-2","py-1","rounded",3,"ngClass"],[1,"space-y-6"],["class","bg-gray-50 p-4 rounded shadow-sm",4,"ngFor","ngForOf"],["pButton","","type","button","label","Nueva respuesta","icon","pi pi-plus",1,"mt-6","p-button-outlined",3,"disabled","click"],[1,"bg-gray-50","p-4","rounded","shadow-sm"],[1,"flex","justify-between","items-center","mb-3",2,"align-items","center","column-gap","1em"],[1,"font-semibold","text-lg"],[1,"text-sm","text-gray-500"],[1,"mb-3","text-gray-700",3,"innerHTML"],["pButton","","type","button","label","Responder","icon","pi pi-reply",1,"p-button-text","p-button-sm",3,"disabled","click"],["class","mt-4 space-y-3 pl-6 border-l-2 border-gray-200",4,"ngIf"],[1,"mt-4","space-y-3","pl-6","border-l-2","border-gray-200"],["class","bg-gray-100 p-3 rounded",4,"ngFor","ngForOf"],[1,"bg-gray-100","p-3","rounded"],[1,"flex","justify-between","items-center","mb-2"],[1,"font-semibold","text-sm"],[1,"text-xs","text-gray-500"],[1,"text-sm","text-gray-600",3,"innerHTML"],[1,"mb-4","p-3","bg-gray-100","rounded"],[1,"font-semibold","mb-2"],[3,"innerHTML"],[1,"text-sm","text-gray-500","mt-2"],["pButton","","type","button","label","Enviar","icon","pi pi-send",1,"p-button-primary",3,"click"],["pButton","","type","button","label","Cancelar","icon","pi pi-times",1,"p-button-secondary","ml-2",3,"click"]],template:function(i,s){1&i&&(e.TgZ(0,"p-panel"),e.YNc(1,z,2,0,"ng-template",0),e.YNc(2,Y,7,3,"div",1),e.qZA(),e.TgZ(3,"p-dialog",2),e.NdJ("visibleChange",function(a){return s.selectedForo=a}),e.YNc(4,j,7,6,"div",3),e.TgZ(5,"p-editor",4),e.NdJ("ngModelChange",function(a){return s.newResponse=a}),e.qZA(),e.YNc(6,$,2,0,"ng-template",5),e.qZA()),2&i&&(e.xp6(2),e.Q6J("ngForOf",s.foros),e.xp6(1),e.Akn(e.DdM(10,K)),e.Q6J("visible",s.selectedForo)("modal",!0)("breakpoints",e.DdM(11,V)),e.xp6(1),e.Q6J("ngIf",s.selectedRespuesta),e.xp6(1),e.Akn(e.DdM(12,G)),e.Q6J("ngModel",s.newResponse))},dependencies:[U.jx,C.Hq,v.mk,v.sg,v.O5,h.s,m.JJ,m.On,M.ML,T.V,v.uU],styles:["p-panel[_ngcontent-%COMP%]{border:1px solid #ddd;border-radius:4px;padding:1rem;background-color:#f5f5f5}p-panel[_ngcontent-%COMP%]   .text-primary[_ngcontent-%COMP%]{color:#007bff}p-panel[_ngcontent-%COMP%]   .ui-panel-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;border-bottom:1px solid #ddd;padding-bottom:.5rem;margin-bottom:1rem}.forum-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:1rem}.forum-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .forum-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}.forum-detail[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #ddd;border-radius:4px;padding:1rem;margin-bottom:1rem}.forum-dates[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:1rem}.forum-dates[_ngcontent-%COMP%]   i.pi-calendar[_ngcontent-%COMP%]{font-size:1.2rem;margin-right:.5rem}.forum-dates[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:1rem}.days-remaining[_ngcontent-%COMP%]{font-weight:700}.days-remaining.due-soon[_ngcontent-%COMP%]{color:#ff5722}.days-remaining.on-time[_ngcontent-%COMP%]{color:#4caf50}.days-remaining.overdue[_ngcontent-%COMP%]{color:#f44336}button[_ngcontent-%COMP%]{background-color:#007bff;border:none;color:#fff;padding:.5rem 1rem;border-radius:4px;cursor:pointer;font-size:1rem;transition:background-color .3s,opacity .3s}button[_ngcontent-%COMP%]:hover{background-color:#0056b3}button.disabled[_ngcontent-%COMP%]{background-color:#6c757d;cursor:not-allowed;opacity:.6}button[_ngcontent-%COMP%]:disabled{background-color:#6c757d;cursor:not-allowed;opacity:.6}p-dialog[_ngcontent-%COMP%]{max-width:600px;border-radius:8px}.p-editor[_ngcontent-%COMP%]{margin-bottom:1rem}ul[_ngcontent-%COMP%]{list-style-type:none}"]})}return o})(),X=(()=>{class o{static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275mod=e.oAB({type:o});static#n=this.\u0275inj=e.cJS({imports:[r.Bz.forChild([{path:"",component:W}]),r.Bz,h.Q,m.u5,M.Z_,x._8,y.U$,d.Xt,C.hJ,u.JH,m.UX,p.j,g.A,b.KZ,_.T,F.q4,O.kW,Z.q,R.EV,D.n,S.O,P.z,J.D,M.Z_,T.S,E.DL,H.aw]})}return o})()},6218:(A,f,n)=>{n.d(f,{A:()=>y,g:()=>x});var r=n(8926),h=n(6814),m=n(6223);let x=(()=>{class d{el;ngModel;control;cd;autoResize;onResize=new r.vpe;filled;cachedScrollHeight;ngModelSubscription;ngControlSubscription;constructor(u,p,g,b){this.el=u,this.ngModel=p,this.control=g,this.cd=b}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewChecked(){this.updateState()}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(u){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}resize(u){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(u||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}static \u0275fac=function(p){return new(p||d)(r.Y36(r.SBq),r.Y36(m.On,8),r.Y36(m.a5,8),r.Y36(r.sBO))};static \u0275dir=r.lG2({type:d,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:4,hostBindings:function(p,g){1&p&&r.NdJ("input",function(_){return g.onInput(_)}),2&p&&r.ekj("p-filled",g.filled)("p-inputtextarea-resizable",g.autoResize)},inputs:{autoResize:"autoResize"},outputs:{onResize:"onResize"}})}return d})(),y=(()=>{class d{static \u0275fac=function(p){return new(p||d)};static \u0275mod=r.oAB({type:d});static \u0275inj=r.cJS({imports:[h.ez]})}return d})()}}]);