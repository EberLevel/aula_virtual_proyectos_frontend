"use strict";(self.webpackChunkapollo_ng=self.webpackChunkapollo_ng||[]).push([[9142],{9142:(K,p,r)=>{r.r(p),r.d(p,{HorarioModule:()=>z});var h=r(6814),d=r(6223),v=r(8007),E=r(5932),y=r(6111),M=r(3023),t=r(8926),m=r(6031),g=r(8672),u=r(2495),f=r(3530),b=r(5219),_=r(6218),x=r(6760),T=r(3714),C=r(3965);function D(i,s){1&i&&t._UZ(0,"ngx-spinner",8)}function w(i,s){if(1&i&&(t.TgZ(0,"span",9),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Oqu("display"===e.view?e.changedEvent.title:"new"===e.view?"Nuevo Evento":"Editar Evento")}}function S(i,s){if(1&i&&(t.TgZ(0,"div")(1,"div",11)(2,"div",12)(3,"div",13),t._uU(4,"Inicio"),t.qZA(),t.TgZ(5,"p",14),t._UZ(6,"i",15),t.TgZ(7,"span"),t._uU(8),t.qZA()()(),t.TgZ(9,"div",12)(10,"div",13),t._uU(11,"Fin"),t.qZA(),t.TgZ(12,"p",14),t._UZ(13,"i",15),t.TgZ(14,"span"),t._uU(15),t.qZA()()(),t.TgZ(16,"div",16)(17,"div",13),t._uU(18,"Color"),t.qZA(),t.TgZ(19,"p",14),t._UZ(20,"span",17),t.TgZ(21,"span"),t._uU(22),t.qZA()()()()()),2&i){const e=t.oxw(2);t.xp6(8),t.Oqu(e.changedEvent.start.toISOString().slice(0,10)),t.xp6(7),t.Oqu(e.changedEvent.end.toISOString().slice(0,10)),t.xp6(5),t.Udp("background-color",e.changedEvent.tag.color),t.xp6(2),t.Oqu(e.changedEvent.tag.name)}}function H(i,s){if(1&i&&(t.TgZ(0,"div",39),t._UZ(1,"div",40),t.TgZ(2,"div"),t._uU(3),t.qZA()()),2&i){const e=t.oxw(4);t.xp6(1),t.Udp("background-color",e.changedEvent.tag.color),t.xp6(2),t.Oqu(e.changedEvent.tag.name)}}function A(i,s){if(1&i&&t.YNc(0,H,4,3,"div",38),2&i){const e=t.oxw(3);t.Q6J("ngIf",e.changedEvent.tag)}}function U(i,s){if(1&i&&(t.TgZ(0,"div",39),t._UZ(1,"div",40),t.TgZ(2,"div"),t._uU(3),t.qZA()()),2&i){const e=s.$implicit;t.xp6(1),t.Udp("background-color",e.color),t.xp6(2),t.Oqu(e.name)}}function O(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"div",18)(2,"div",19)(3,"label",20),t._uU(4,"T\xedtulo"),t.qZA(),t.TgZ(5,"span",21),t._UZ(6,"i",22),t.TgZ(7,"input",23),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw(2);return t.KtG(a.changedEvent.title=o)}),t.qZA()()(),t.TgZ(8,"div",19)(9,"label",24),t._uU(10,"Ubicaci\xf3n"),t.qZA(),t.TgZ(11,"span",21),t._UZ(12,"i",25),t.TgZ(13,"input",26),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw(2);return t.KtG(a.changedEvent.location=o)}),t.qZA()()(),t.TgZ(14,"div",27)(15,"label",28),t._uU(16,"Descripci\xf3n del evento"),t.qZA(),t.TgZ(17,"textarea",29),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw(2);return t.KtG(a.changedEvent.description=o)}),t.qZA()(),t.TgZ(18,"div",19)(19,"label",30),t._uU(20,"Fecha de Inicio"),t.qZA(),t.TgZ(21,"p-calendar",31),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw(2);return t.KtG(a.changedEvent.start=o)}),t.qZA()(),t.TgZ(22,"div",19)(23,"label",32),t._uU(24,"Fecha Fin"),t.qZA(),t.TgZ(25,"p-calendar",33),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw(2);return t.KtG(a.changedEvent.end=o)}),t.qZA()(),t.TgZ(26,"div",27)(27,"label",34),t._uU(28,"Color"),t.qZA(),t.TgZ(29,"p-dropdown",35),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw(2);return t.KtG(a.changedEvent.tag=o)}),t.YNc(30,A,1,1,"ng-template",36),t.YNc(31,U,4,3,"ng-template",37),t.qZA()()()()}if(2&i){const e=t.oxw(2),n=t.MAs(4);t.xp6(7),t.Q6J("ngModel",e.changedEvent.title),t.xp6(6),t.Q6J("ngModel",e.changedEvent.location),t.xp6(4),t.Q6J("rows",5)("ngModel",e.changedEvent.description),t.xp6(4),t.Q6J("appendTo",n)("maxDate",e.changedEvent.end)("showTime",!0)("required",!0)("ngModel",e.changedEvent.start),t.xp6(4),t.Q6J("appendTo",n)("minDate",e.changedEvent.start)("showTime",!0)("required",!0)("ngModel",e.changedEvent.end),t.xp6(4),t.Q6J("appendTo",n)("options",e.tags)("ngModel",e.changedEvent.tag)}}function J(i,s){if(1&i&&(t.YNc(0,S,23,5,"div",10),t.YNc(1,O,32,17,"div",10)),2&i){const e=t.oxw();t.Q6J("ngIf","display"===e.view),t.xp6(1),t.Q6J("ngIf","display"!==e.view)}}function I(i,s){}const N=function(){return{width:"36rem"}},k=function(){return{"960px":"75vw","640px":"90vw"}};let F=(()=>{class i{constructor(e,n){this.eventService=e,this.spinner=n,this.events=[],this.today="",this.calendarOptions={initialView:"dayGridMonth"},this.isLoading=!1,this.showDialog=!1,this.clickedEvent=null,this.dateClicked=!1,this.edit=!1,this.tags=[],this.view="",this.courseStyles={}}ngOnInit(){this.today=(new Date).toISOString().split("T")[0],this.isLoading=!0,this.spinner.show(),this.eventService.getEventsDocente({docente_id:1}).subscribe({next:n=>{this.events=this.getEventsAlumno(n),this.calendarOptions={...this.calendarOptions,events:this.events},this.tags=this.events.map(o=>{if(!this.tags.includes(o.tag))return o.tag}).filter(o=>void 0!==o),this.spinner.hide(),this.isLoading=!1},error:n=>{console.error("Error al obtener eventos:",n),this.spinner.hide(),this.isLoading=!1}}),this.calendarOptions={plugins:[E.Z,M.Z,y.ZP],height:720,initialDate:this.today,headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,eventClick:n=>this.onEventClick(n),select:n=>this.onDateSelect(n),events:this.events}}getEventsAlumno(e){const n=e.map(o=>{const a=JSON.parse(o.horarios);return this.generateEventDetails(a)});return console.log(n.flat()),n.flat()}generateEventDetails(e){const n=[];return e.forEach(o=>{const a=this.getCourseStyles(o.cursoNombre),c=new Date(o.fecha_inicio),L=new Date(o.fecha_fin),Z=o.day_id;for(let l=new Date(c);l<=L;l=this.addDays(l,1))if(l.getDay()===Z%7){const P=`${l.toISOString().split("T")[0]}T${o.hora_inicio}`,j=`${l.toISOString().split("T")[0]}T${o.hora_fin}`;n.push({day_name:this.getDayName(Z),date:l.toISOString().split("T")[0],end:j,start:P,tag:{color:"#FFD700",name:o.cursoNombre},title:o.cursoNombre,borderColor:a.borderColor,backgroundColor:a.backgroundColor,textColor:a.textColor})}}),n}getCourseStyles(e){if(this.courseStyles[e])return this.courseStyles[e];const n=this.generateStyles();return this.courseStyles[e]=n,n}getDayName(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e%7]}addDays(e,n){const o=new Date(e);return o.setDate(o.getDate()+n),o}generateStyles(){const n=["#f9e79f","#a3e4d7","#abebc6","#f5b041","#ec7063","#cacfd2"],o=["#000000"],a=n[Math.floor(Math.random()*n.length)];return{backgroundColor:a,borderColor:a,textColor:o[Math.floor(Math.random()*o.length)]}}onEventClick(e){this.clickedEvent=e.event;let n=e.event.toPlainObject({collapseExtendedProps:!0,collapseColor:!0});this.view="display",this.showDialog=!0,this.changedEvent={...n,...this.clickedEvent},this.changedEvent.start=this.clickedEvent.start,this.changedEvent.end=this.clickedEvent.end?this.clickedEvent.end:this.clickedEvent.start}onDateSelect(e){}handleSave(){this.validate()&&(this.showDialog=!1,this.clickedEvent={...this.changedEvent,backgroundColor:this.changedEvent.tag.color,borderColor:this.changedEvent.tag.color,textColor:"#212121"},this.events=this.clickedEvent.hasOwnProperty("id")?this.events.map(e=>e.id.toString()===this.clickedEvent.id.toString()?e=this.clickedEvent:e):[...this.events,{...this.clickedEvent,id:Math.floor(1e4*Math.random())}],this.calendarOptions={...this.calendarOptions,events:this.events},this.clickedEvent=null)}onEditClick(){this.view="edit"}delete(){this.events=this.events.filter(e=>e.id.toString()!==this.clickedEvent.id.toString()),this.calendarOptions={...this.calendarOptions,events:this.events},this.showDialog=!1}validate(){let{start:e,end:n}=this.changedEvent;return e&&n}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(m.P),t.Y36(g.t2))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-horario"]],decls:8,vars:10,consts:[[1,"card"],[3,"options"],["bdColor","rgba(0,0,0,0.5)","size","large","color","#fff","type","ball-spin",4,"ngIf"],[3,"visible","breakpoints","modal","closable","visibleChange","onHide"],["dd",""],["pTemplate","header"],["pTemplate","content"],["pTemplate","footer"],["bdColor","rgba(0,0,0,0.5)","size","large","color","#fff","type","ball-spin"],[1,"text-900","font-semibold","text-xl"],[4,"ngIf"],[1,"grid"],[1,"col-6"],[1,"text-900","font-semibold","mb-2"],[1,"flex","align-items-center","m-0"],[1,"pi","pi-fw","pi-clock","text-700","mr-2"],[1,"col-12"],[1,"inline-flex","flex-shrink-0","w-1rem","h-1rem","mr-2","border-circle"],[1,"grid","p-fluid","formgrid"],[1,"col-12","md:col-6","field"],["for","title",1,"text-900","font-semibold"],[1,"p-input-icon-left"],[1,"pi","pi-pencil"],["id","title","type","text","pInputText","","placeholder","T\xedtulo",3,"ngModel","ngModelChange"],["for","location",1,"text-900","font-semibold"],[1,"pi","pi-map-marker"],["id","location","type","text","pInputText","","placeholder","Ubicaci\xf3n",3,"ngModel","ngModelChange"],[1,"col-12","field"],["for","description",1,"text-900","font-semibold"],["id","description","type","text","pInputTextarea","",2,"resize","none",3,"rows","ngModel","ngModelChange"],["for","start",1,"text-900","font-semibold"],["dateFormat","dd-mm-yy","inputId","start",3,"appendTo","maxDate","showTime","required","ngModel","ngModelChange"],["for","end",1,"text-900","font-semibold"],["dateFormat","dd-mm-yy","inputId","end",3,"appendTo","minDate","showTime","required","ngModel","ngModelChange"],["for","company-color",1,"text-900","font-semibold"],["inputId","company-color","optionLabel","name",3,"appendTo","options","ngModel","ngModelChange"],["pTemplate","selectedItem"],["pTemplate","item"],["class","flex align-items-center",4,"ngIf"],[1,"flex","align-items-center"],[1,"flex-shrink-0","w-1rem","h-1rem","mr-2","border-circle"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0),t._UZ(1,"full-calendar",1),t.YNc(2,D,1,0,"ngx-spinner",2),t.TgZ(3,"p-dialog",3,4),t.NdJ("visibleChange",function(c){return o.showDialog=c})("onHide",function(){return o.view=""}),t.YNc(5,w,2,1,"ng-template",5),t.YNc(6,J,2,2,"ng-template",6),t.YNc(7,I,0,0,"ng-template",7),t.qZA()()),2&n&&(t.xp6(1),t.Q6J("options",o.calendarOptions),t.xp6(1),t.Q6J("ngIf",o.isLoading),t.xp6(1),t.Akn(t.DdM(8,N)),t.Q6J("visible",o.showDialog)("breakpoints",t.DdM(9,k))("modal",!0)("closable",!0))},dependencies:[h.O5,d.Fj,d.JJ,d.Q7,d.On,u.w,f.V,b.jx,_.g,x.f,T.o,C.Lt,g.Ro]})}return i})(),Q=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[v.Bz.forChild([{path:"",component:F}]),v.Bz]})}return i})();var q=r(707),Y=r(4480),G=r(4104);let z=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({providers:[m.P],imports:[h.ez,d.u5,Q,u.z,f.S,_.A,q.hJ,x._8,T.j,C.kW,G.EV,Y.T,g.ef]})}return i})()}}]);